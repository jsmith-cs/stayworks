<div class="property-container">

   <!-- Button trigger modal -->

  
  <div class="card">
    <div class="card-body">
      
      
      <div class="d-flex flex-row bd-highlight mb-3">
        <div class="p-2 bd-highlight"> <h3 class="bi bi-houses-fill"> My Properties</h3></div>
        <div class="p-2 bd-highlight"></div>
        <div class="p-2 bd-highlight"><button type="button" class="btn dBlue" data-bs-toggle="modal" data-bs-target="#modalAddProperty">
          + Add Property
        </button></div>
      </div>

      <div>
        <table class="table table-bordered table-striped table-hover p-1000">
          <thead class="table-secondary">
            <tr>
              <th scope="col">Address</th>
              <th scope="col">City</th>
              <th scope="col">Country</th>
              <th scope="col">Postal Code</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let p of propertyList">
              <td><a href="" onclick="return false;" (click)="onClickRetrieveProperty(p.propertyId)" data-bs-toggle="modal" data-bs-target="#modalPropertyInfo">{{p.address}}</a></td>
              <td>{{p.City}}</td>
              <td>{{p.Country}}</td>
              <td>{{p.PostalCode}}</td>
            </tr>
      
          </tbody>
        </table>
      </div>


      <!-- <div class="d-flex flex-row bd-highlight mb-3">
        <div class="p-2 bd-highlight"><h3 class="bi bi-archive-fill"> My Documents</h3></div>
        <div class="p-2 bd-highlight"></div>
        <div class="p-2 bd-highlight"><button type="button" class="btn dBlue" data-bs-toggle="modal" data-bs-target="#modalAddDocument">
          + Add Documents
        </button></div>
      </div>
      <div>
        <table class="table table-bordered table-striped table-hover p-1000">
          <thead class="table-secondary">
            <tr>
              <th scope="col">docId</th>
              <th scope="col">docType</th>
              <th scope="col">FileName</th>
              <th scope="col">Created At</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let f of fileList">
              <td><a href="" onclick="return false;" (click)="onClickRetrieve(f.docId)">{{f.docId}}</a></td>
              <td>{{f.docType}}</td>
              <td>{{f.fileName}}</td>
              <td>{{f.CreatedAt}}</td>
            </tr>
      
          </tbody>
        </table>
      </div> -->
    </div>

    


  </div>

  <!-- Modal -->
  <div class="modal fade" id="modalAddProperty" tabindex="-1" aria-labelledby="modalAddPropertyLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Add a Property</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form [formGroup]="propertyForm" (ngSubmit)="submitProperty()">
            <div>
              <div class="mb-3">
                <label for="exampleInputEmail1" class="form-label">Address</label>
                <input
                  type="email"
                  class="form-control"
                  id="address"
                  formControlName="address"
                  aria-describedby="emailHelp"
                />
              </div>
              <div class="mb-3">
                <label for="exampleInputEmail1" class="form-label">City</label>
                <input
                  type="email"
                  class="form-control"
                  id="city"
                  formControlName="city"
                  aria-describedby="emailHelp"
                />
              </div>
              <div class="mb-3">
                <label for="exampleInputEmail1" class="form-label">Province</label>
                <input
                  type="email"
                  class="form-control"
                  id="province"
                  formControlName="province"
                  aria-describedby="emailHelp"
                />
              </div>
              <div class="mb-3">
                <label for="exampleInputEmail1" class="form-label">Country</label>
                <input
                  type="email"
                  class="form-control"
                  id="country"
                  formControlName="country"
                  aria-describedby="emailHelp"
                />
              </div>
              <div class="mb-3">
                <label for="exampleInputEmail1" class="form-label">Postal Code</label>
                <input
                  type="email"
                  class="form-control"
                  id="postalCode"
                  formControlName="postalCode"
                  aria-describedby="emailHelp"
                />
              </div>
            </div>
        
            <button class="btn btn-primary" type="submit">Submit</button>
          </form>

          
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>



  <div class="modal fade" id="modalAddDocument" tabindex="-1" aria-labelledby="modalAddDocumentLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Add a Property</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">       
          <form [formGroup]="myForm" (ngSubmit)="submit()">
            <div class="form-group">
              <label for="name">Name</label>
              <select
                class="form-select"
                aria-label="Default select example"
                id="fileType"
                formControlName="fileType"
              >
                <option value="Lease">Lease Document</option>
                <option value="Property">Property Document</option>
                <option value="Other">Other Document</option>
              </select>
            </div>

            <div class="form-group">
              <label for="file">File</label>
              <input
                formControlName="file"
                id="file"
                type="file"
                class="form-control"
                (change)="onFileChange($event)"
              />
            </div>
            <br>
            <button class="btn btn-primary" type="submit">Submit</button>
          </form>


          
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="modalPropertyInfo" tabindex="-1" aria-labelledby="modalPropertyInfo" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="exampleModalLabel"><i class="bi bi-house-fill"></i> {{this.currentPropertyInfo.address}}</h3>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div>      
            <button type="button" class="btn dBlue" data-bs-toggle="modal" data-bs-target="#modalAddDocument">
              <i class="bi bi-file-earmark-arrow-up-fill"></i> + Add Documents
            </button>
            <br>
            <br>
            <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#modalAddExpense">
              <i class="bi bi-currency-dollar"></i> + Add Expense 
            </button>
            <br>
            <br>
          </div>
          



          <div class="main-content">
            <!-- <button (click)="showAddForm()" class="add-button">Add Tenant</button> -->
            <h3> <i class="bi bi-people-fill"></i> Your Tenants <button type="button" class="btn dBlue" data-bs-dismiss="modal" (click)="showAddForm()" id="btnTenants">
              <i class="bi bi-person-fill-add"></i> +
            </button></h3>
            <div *ngIf="tenants.length === 0" class="no-tenants">
              No tenants yet. Click the button above to add a tenant.
            </div>
            <ul class="tenant-list" *ngIf="tenants.length > 0">
              <li *ngFor="let tenant of tenants" class="tenant-item">
                <div class="tenant-info">
                  <h3 class="tenant-name">{{ tenant.first_name }} {{ tenant.last_name }}</h3>
                  <p class="tenant-contact">
                    <span class="email">{{ tenant.email }}</span>
                    <span class="phone">{{ tenant.phone }}</span>
                  </p>
                </div>
                <div class="tenant-actions">
                  <button (click)="viewTenant(tenant)"  data-bs-dismiss="modal" class="view-button">View</button>
                  <button (click)="editTenant(tenant)"  data-bs-dismiss="modal" class="edit-button">Edit</button>
                  <button (click)="confirmDeleteTenant(tenant.id)"  data-bs-dismiss="modal" class="delete-button">Delete</button>
                </div>
              </li>
            </ul>
           
          </div>
          

          
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
    <app-tenant-form 
      *ngIf="showForm" 
      [tenant]="selectedTenant" 
      (save)="saveTenant($event)" 
      (cancel)="cancelForm()">
    </app-tenant-form>
    <app-tenant-view
      *ngIf="showViewPanel"
      [tenant]="selectedTenant"
      (close)="closeViewPanel()">
    </app-tenant-view>



    <div class="modal fade" id="modalAddExpense" tabindex="-1" aria-labelledby="modalAddExpense" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Add a Property</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form [formGroup]="expenseForm" class="needs-validation" novalidate>
    
              <div class="mb-3">
                <label for="expenseDate" class="form-label">Expense Date</label>
                <input
                  type="date"
                  class="form-control"
                  id="expenseDate"
                  formControlName="expenseDate"
                  required
                />
              </div>
            
              <div class="mb-3">
                <label for="category" class="form-label">Category</label>
                <select
                  class="form-select"
                  id="category"
                  formControlName="category"
                  required
                >
                  <option value="" selected disabled>Select Category</option>
                  <option value="Utilities">Utilities</option>
                  <option value="Maintenance">Maintenance</option>
                  <option value="Other">Other</option>
                </select>
              </div>
            
              <div class="mb-3">
                <label for="amount" class="form-label">Amount</label>
                <input
                  type="number"
                  class="form-control"
                  id="amount"
                  formControlName="amount"
                  step="0.01"
                  required
                />
              </div>
            
              <div class="mb-3">
                <label for="description" class="form-label">Description</label>
                <textarea
                  class="form-control"
                  id="description"
                  rows="3"
                  formControlName="description"
                ></textarea>
              </div>
            
              <button type="submit" class="btn btn-primary" (click)="saveExpense()">Submit</button>
            </form>
        
  
            
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
    
</div>
